# Relationships 

A **relationship** in SQL defines how data in one table is related to data in another table. Relationships help keep data organized, reduce duplication, and maintain accuracy by connecting tables using the **primary key** and the **foreign key** columns. These relationships allow you to represent real-world connections, such as which student is enrolled in which course.


## Keys in Relationships

### Primary Key (PK)
A column (or set of columns) that uniquely identifies each row in a table. Every table should have at **least one primary key**.

**Example**  
A `Teachers` table that includes an `id` column as a primary key.
```sql
CREATE TABLE Teachers (
    id INT PRIMARY KEY,
    name VARCHAR(50)
);
```

### Foreign Key (FK)
A column refers to the primary key column of another table. establishing a relationship.

**Example**  
A `Courses` table with a `teacher_id` column references the `id` in `Teachers`.
```sql
CREATE TABLE Courses (
    id INT PRIMARY KEY,
    title VARCHAR(100),
    teacher_id INT,
    FOREIGN KEY (teacher_id) REFERENCES Teachers(id)
);
```

## Types of Relationships

SQL supports several types of relationships between tables. The three most common are:


### One-to-One (1:1)
Each row in the first table relates to **one and only one** row in the second table, and vice versa.

**Example**  
Suppose we have two tables: `Teachers` and `Lockers`. Each teacher has exactly one locker.

**Teachers Table**

| id | name      |
|----|-----------|
| 1  | Amal  |
| 2  | Faisal|

**Lockers Table**

| id | teacher_id |
|----|------------|
| 1  | 1          |
| 2  | 2          |


**Tables Definition**
```sql
CREATE TABLE Teachers (
    id INT PRIMARY KEY,
    name VARCHAR(50)
);

CREATE TABLE Lockers (
    id INT PRIMARY KEY,
    teacher_id INT UNIQUE,
    FOREIGN KEY (teacher_id) REFERENCES Teachers(id)
);
```
- `teacher_id` in `Lockers` is a **foreign key** referencing `id` in `Teachers`.
- The `UNIQUE` constraint on `teacher_id` ensures each teacher is assigned only one locker.

### One-to-Many (1:M)
A row in the first table can be related to **multiple rows** in the second table, but each row in the second table relates to **only one** row in the first.

**Example**  
Suppose we have two tables: `Teachers` and `Courses`. Each teacher can teach multiple courses, but each course has only one teacher.

**Teachers Table**

| id | name      |
|----|-----------|
| 1  | Amal  |
| 2  | Faisal|

**Courses Table**

| id | title    | teacher_id |
|----|----------|------------|
| 1  | Math     | 1          |
| 2  | Science  | 1          |
| 3  | English  | 2          |


**Tables Definition**

```sql
CREATE TABLE Teachers (
    id INT PRIMARY KEY,
    name VARCHAR(50)
);

CREATE TABLE Courses (
    id INT PRIMARY KEY,
    title VARCHAR(100),
    teacher_id INT,
    FOREIGN KEY (teacher_id) REFERENCES Teachers(id)
);
```
- `teacher_id` in `Courses` is a **foreign key** referencing `id` in `Teachers`.

### Many-to-Many (M:M)
Rows in the first table can relate to **many rows** in the second table, and vice versa. This type of relationship is implemented by using the **junction table** (also called a linking or bridge).

**Example**  
Suppose we have two tables: `Students` and `Courses`.  Each student can enroll in many courses, and each course can have multiple students.

**Students Table**

| id | name      |
|----|-----------|
| 1  | Waad      |
| 2  | Fahad     |

**Courses Table**

| id | title    | teacher_id |
|----|----------|------------|
| 1  | Math     | 1          |
| 2  | Science  | 1          |
| 3  | English  | 2          |

**Enrollments Table** (junction table)

| student_id | course_id |
|------------|-----------|
| 1          | 2         |
| 1          | 3         |
| 2          | 1         |


**Tables Definition**
```sql
CREATE TABLE Students (
    id INT PRIMARY KEY,
    name VARCHAR(50)
);

CREATE TABLE Courses (
    id INT PRIMARY KEY,
    title VARCHAR(100),
    teacher_id INT,
    FOREIGN KEY (teacher_id) REFERENCES Teachers(id)
);

CREATE TABLE Enrollments (
    student_id INT,
    course_id INT,
    PRIMARY KEY (student_id, course_id),
    FOREIGN KEY (student_id) REFERENCES Students(id),
    FOREIGN KEY (course_id) REFERENCES Courses(id)
);
```

## Cascading Actions

When using foreign keys, you can specify what should happen to related rows when data in the table is updated or deleted using **cascading actions**.

- **ON DELETE CASCADE:** Automatically deletes related rows.
- **ON UPDATE CASCADE:** Automatically updates related foreign key values.


**Example**  
- If a teacher is deleted, all their courses are also deleted.
  ```sql
  FOREIGN KEY (teacher_id) REFERENCES Teachers(id) ON DELETE CASCADE
  ```

- If a teacher's ID changes, the change is reflected in all related courses.
  ```sql
  FOREIGN KEY (teacher_id) REFERENCES Teachers(id) ON UPDATE CASCADE
  ```

## Practice
Create a database using the following steps:

1. Create a database called `Library`.
2. Create an `Authors` table and a `Books` table. Each book has one author, but each author can write many books.
3. Add a foreign key in the `Books` table from `author_id` to `Authors.id`.
4. Insert two authors and three books, assigning books to authors.
